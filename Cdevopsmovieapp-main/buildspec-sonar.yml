version: 0.2

phases:
  install:
    commands:
      - apt-get update -y
      - apt-get install -y unzip wget openjdk-11-jdk

  pre_build:
    commands:
      - echo "Installing SonarScanner..."
      - wget -O sonar-scanner.zip https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-5.0.1.3006-linux.zip
      - unzip sonar-scanner.zip
      - export PATH=$PATH:$(pwd)/sonar-scanner-5.0.1.3006-linux/bin
      - sonar-scanner -h  # Verify installation

  build:
    commands:
      - echo "Running SonarQube Analysis..."
      - sonar-scanner -Dsonar.projectKey=cdos -Dsonar.sources=. -Dsonar.host.url=http://54.210.141.126:8000 -Dsonar.login=sqa_2f68dcbd3ff66b456034d8d56189e4fae0363688
artifacts:
  files: "**/*"
